<!doctype html>
<html lang="en" dir="ltr" class="mdx-wrapper mdx-page plugin-pages plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">RankStore</title><meta data-rh="true" property="og:title" content="RankStore"><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://123marble.github.io/RankStore/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="description" content="üöß This library is still under construction...üöß"><meta data-rh="true" property="og:description" content="üöß This library is still under construction...üöß"><link data-rh="true" rel="canonical" href="https://123marble.github.io/RankStore/"><link data-rh="true" rel="alternate" href="https://123marble.github.io/RankStore/" hreflang="en"><link data-rh="true" rel="alternate" href="https://123marble.github.io/RankStore/" hreflang="x-default"><script data-rh="true">function maybeInsertBanner(){window.__DOCUSAURUS_INSERT_BASEURL_BANNER&&insertBanner()}function insertBanner(){var n=document.getElementById("docusaurus-base-url-issue-banner-container");if(n){n.innerHTML='\n<div id="docusaurus-base-url-issue-banner" style="border: thick solid red; background-color: rgb(255, 230, 179); margin: 20px; padding: 20px; font-size: 20px;">\n   <p style="font-weight: bold; font-size: 30px;">Your Docusaurus site did not load properly.</p>\n   <p>A very common reason is a wrong site <a href="https://docusaurus.io/docs/docusaurus.config.js/#baseurl" style="font-weight: bold;">baseUrl configuration</a>.</p>\n   <p>Current configured baseUrl = <span style="font-weight: bold; color: red;">/RankStore/</span> </p>\n   <p>We suggest trying baseUrl = <span id="docusaurus-base-url-issue-banner-suggestion-container" style="font-weight: bold; color: green;"></span></p>\n</div>\n';var e=document.getElementById("docusaurus-base-url-issue-banner-suggestion-container"),s=window.location.pathname,r="/"===s.substr(-1)?s:s+"/";e.innerHTML=r}}window.__DOCUSAURUS_INSERT_BASEURL_BANNER=!0,document.addEventListener("DOMContentLoaded",maybeInsertBanner)</script><link rel="stylesheet" href="/RankStore/assets/css/styles.19a5646f.css">
<link rel="preload" href="/RankStore/assets/js/runtime~main.f47a0cfc.js" as="script">
<link rel="preload" href="/RankStore/assets/js/main.443f9169.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div id="docusaurus-base-url-issue-banner-container"></div><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/RankStore/"><b class="navbar__title text--truncate">RankStore</b></a><a class="navbar__item navbar__link" href="/RankStore/api/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/123marble/RankStore" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><main class="container container--fluid margin-vert--lg"><div class="row mdxPageWrapper_j9I6"><div class="col col--8"><article><p>üöß This library is still under construction...üöß</p><h1>Rank Store</h1><p>RankStore is a reliable and scalable system for managing persistent leaderboards using ROBLOX DataStores. RankStore provides a ranking of leaderboard identities based on a score. </p><ul><li>üîç Employs Binary Search for optimal insertion and retrieval of entries</li><li>üöÄ Compresses data to a higher base to minimise storage size</li><li>üõ°Ô∏è Ensures high data integrity by using atomic updates where possible or calling recovery methods in the event of consistency errors</li><li>‚≠ê Stores data across multiple keys to be scalable to thousands of identities</li></ul><p>This module aims to overcome the commonly encountered limitation of the Ordered Datastore which does not allow retrieval of specific ranks. At present, Ordered Datastores can only read 100 records per page and the entries must be read in sequence, which is impractical for large leaderboards with thousands of entries.</p><h1>Limitations</h1><ul><li>Some use cases will be too intensive for this module. While RankStore has been designed with efficiency in mind, it has to operate within the <a href="https://create.roblox.com/docs/cloud-services/data-stores#server-limits" target="_blank" rel="noopener noreferrer">limits of ROBLOX Datastores</a>, which cannot be changed. See the <a href="#performance">Performance Section</a> to gauge whether RankStore is viable for your use case.</li><li>The entry ID and score must be 5 byte and 4 byte <strong>integers</strong> respectively.</li></ul><h1>Usage</h1><p>Add `` to your wally.toml or grab the model here.</p><div class="language-lua codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lua codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">local</span><span class="token plain"> RankStore </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">game</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ServerScriptService</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">RankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">local</span><span class="token plain"> rankStore </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">GetRankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MyLeaderboard&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token function" style="color:rgb(130, 170, 255)">SetScoreAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">25</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- pass in user id, score</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token function" style="color:rgb(130, 170, 255)">SetScoreAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token function" style="color:rgb(130, 170, 255)">SetScoreAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token function" style="color:rgb(130, 170, 255)">SetScoreAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">75</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token function" style="color:rgb(130, 170, 255)">GetTopScoresAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rankStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token function" style="color:rgb(130, 170, 255)">GetEntryAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Full API is available on <a href="https://123marble.github.io/RankStore/api/RankStore" target="_blank" rel="noopener noreferrer">123marble.github.io/RankStore/api/RankStore</a>.</p><h1>Performance</h1><table><thead><tr><th>Method</th><th>Algorithm Time Complexity</th><th>Network Time Complexity</th><th>Datastore Requests</th></tr></thead><tbody><tr><td>GetRankStore</td><td>O(1)</td><td>O(1)</td><td>1 GetAsync</td></tr><tr><td>SetScoreAsync</td><td>O(log n)</td><td>O(n)</td><td>2 UpdateAsync<br> N-1 GetAsync</td></tr><tr><td>GetEntryAsync</td><td>O(log n)</td><td>O(n)</td><td>N GetAsync</td></tr><tr><td>GetTopScoresAsync (k)</td><td>O(k)</td><td>O(n)</td><td>N GetAsync</td></tr><tr><td>RemoveEntryAsync</td><td></td><td></td><td></td></tr><tr><td>ClearAsync</td><td>O(1)</td><td>O(1)</td><td>1 SetAsync</td></tr></tbody></table><p><strong>N=num buckets, n=total entries</strong></p><p><strong>NB: A DataStore GetAsync or UpdateAsync request retrieves the entire value over the network so the actual time complexity for any leaderboard operations is O(n).</strong></p><p><strong>NB: The N GetAsync requests are always made in parallel.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="concurrency">Concurrency<a href="#concurrency" class="hash-link" aria-label="Direct link to Concurrency" title="Direct link to Concurrency">‚Äã</a></h2><ul><li>How DataStore handles concurrent requests is not documented.</li><li>Number of Datastore keys is effectively the maximum number of maximum concurrent SetScoreAsync requests.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="datastore-limits">DataStore Limits<a href="#datastore-limits" class="hash-link" aria-label="Direct link to DataStore Limits" title="Direct link to DataStore Limits">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-limits">Data Limits<a href="#data-limits" class="hash-link" aria-label="Direct link to Data Limits" title="Direct link to Data Limits">‚Äã</a></h3><p>Each entry requires only 9 characters for storage. The current storage limit for DataStore is 4,194,304 characters per key which means that approximately a maximum of 450k entries are storable in 1 key.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server-and-throughput-limits">Server and Throughput Limits<a href="#server-and-throughput-limits" class="hash-link" aria-label="Direct link to Server and Throughput Limits" title="Direct link to Server and Throughput Limits">‚Äã</a></h3><p>There is a trade-off between number of keys and the maximum number of records per key. Choosing a higher number of keys will:</p><ul><li>Worsen the DataStore request budget because the number of GetAsync requests is linearly proportional to the number of keys.</li><li>Improve the DataStore throughput budget because throughput limits are enforced per key.</li></ul><p>Conversely, increasing the size of individual keys will improve the request budget but worsen the throughput budget.</p><h1>Contribute</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-run-the-unit-tests">How do I run the unit tests?<a href="#how-do-i-run-the-unit-tests" class="hash-link" aria-label="Direct link to How do I run the unit tests?" title="Direct link to How do I run the unit tests?">‚Äã</a></h2><p>Testing requires Wally, Rojo, and Roblox Studio.</p><ol><li>Install packages with <code>wally install</code></li><li>Sync <code>rojo</code> with <code>default.project.json</code></li><li>Run the Roblox Studio place</li><li>Check output window for test status</li></ol></article></div><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#concurrency" class="table-of-contents__link toc-highlight">Concurrency</a></li><li><a href="#datastore-limits" class="table-of-contents__link toc-highlight">DataStore Limits</a><ul><li><a href="#data-limits" class="table-of-contents__link toc-highlight">Data Limits</a></li><li><a href="#server-and-throughput-limits" class="table-of-contents__link toc-highlight">Server and Throughput Limits</a></li></ul></li><li><a href="#how-do-i-run-the-unit-tests" class="table-of-contents__link toc-highlight">How do I run the unit tests?</a></li></ul></div></div></div></main></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 AuthorName. Built with Moonwave and Docusaurus</div></div></div></footer></div>
<script src="/RankStore/assets/js/runtime~main.f47a0cfc.js"></script>
<script src="/RankStore/assets/js/main.443f9169.js"></script>
</body>
</html>